<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:rich="http://richfaces.org/rich">
      
        <rich:panel header="Request">
            <a4j:outputPanel id="parInputPanel" ajaxRendered="true"> <!-- The tree must live within a ajaxRendered outputPanel in order for properly refreshing! -->
                            <div>
                                <i>#{clientConversationBean.currentOperationFullName}</i>
                            </div>
                            <rich:tree id="richTree" var="node" value="#{clientConversationBean.inputTree}" nodeType="#{node.kind}" 
		        		        switchType="ajax" binding="#{clientConversationBean.inTree}">
				                <rich:treeNode type="simple">
				                	<h:outputText value="#{node.type} : #{node.name} " />
        					        <h:selectBooleanCheckbox id="foo-chk" value="#{node.notNil}" disabled="#{node.notNillable}" >
		        			           <f:ajax />
					                </h:selectBooleanCheckbox>
        					        <h:inputText value="#{node.value}" id="foo" label="" rendered="#{node.type!='boolean' and node.type!='Boolean'}" columns="10"  >
		        			           <f:ajax event="valueChange" render="foo-chk" listener="#{clientConversationBean.onInputFocus(node)}" />
				        	        </h:inputText>
					                <h:selectOneMenu value="#{node.value}" rendered="#{node.type=='boolean' or node.type=='Boolean'}">
        						        <f:selectItem itemValue="true" itemLabel="true" />
        						        <f:selectItem itemValue="false" itemLabel="false" />
                					</h:selectOneMenu>
				        	        <a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				                		Remove
                					</a4j:commandLink>
		        		        </rich:treeNode>
				                <rich:treeNode type="group" expanded="#{node.expanded}">
					                <h:outputText value="[#{node.type}]" styleClass="tipoCampo" />
                					<h:selectBooleanCheckbox value="#{node.notNil}" disabled="true" />
		                			<h:outputText value="&nbsp;" />
		                			<a4j:commandLink name="Add" action="#{clientConversationBean.addChild(node)}" reRender="richTree">
						                Add
                					</a4j:commandLink>
                					<a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				                		Remove
        				        	</a4j:commandLink>
        		        		</rich:treeNode>
		        		        <rich:treeNode type="lazy">
				                    <h:outputText value="#{node.type} ..." />
		        		        	<h:outputText value="&nbsp;" />
        		        			<a4j:commandLink name="Load" action="#{clientConversationBean.lazyLoadChild(node)}" reRender="richTree" rendered="#{not node.resolved}">
		        				        Load 
        		        			</a4j:commandLink>
					                <a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				        		        Remove
                					</a4j:commandLink>
		                		</rich:treeNode>
				                <rich:treeNode type="complex" expanded="#{node.expanded}">
					                <h:outputText value="#{node.type} : #{node.name} " />
        					        <h:selectBooleanCheckbox value="#{node.notNil}" disabled="#{node.notNillable}" >
		        			           <f:ajax />
				        	        </h:selectBooleanCheckbox>
        				        	<h:outputText value="&nbsp;&nbsp;" />
        					        <a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
		        		        		Remove
        		        			</a4j:commandLink>
				                </rich:treeNode>
        				        <rich:treeNode type="Parameterized" expanded="#{node.expanded}">
		        			        <h:outputText value="{#{node.namespace}} " />
				        	        <h:selectBooleanCheckbox value="#{node.notNil}" disabled="true" />
				                </rich:treeNode>
        				        <rich:treeNode type="XMLGregorianCalendar">
                					        <h:outputText value="#{node.type} : #{node.name} " styleClass="tipoCampo" />
		                			<h:selectBooleanCheckbox id="foo2-chk" value="#{node.notNil}" disabled="#{node.notNillable}" >
		        		        	   <f:ajax />
        					        </h:selectBooleanCheckbox>
		        		        	<rich:calendar id="foo2" value="#{node.valueDate}" popup="true" showInput="true" enableManualInput="false" >
				        		        <f:ajax event="change" render="foo2-chk" listener="#{clientConversationBean.onInputFocus(node)}" />
						            </rich:calendar>
                					<a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
		        		        		Remove
        		        			</a4j:commandLink>
        		        		</rich:treeNode>
		        		        <rich:treeNode type="Duration">
        		        			<h:outputText value="#{node.type} : #{node.name} " styleClass="tipoCampo" />
		        		        	<h:selectBooleanCheckbox id="foo3-chk" value="#{node.notNil}" disabled="#{node.notNillable}" >
        		        			   <f:ajax />
		        			        </h:selectBooleanCheckbox>
				                	<h:inputText id="foo3" value="#{node.value}">
				                	   <f:ajax event="valueChange" render="foo3-chk" listener="#{clientConversationBean.onInputFocus(node)}" />
        				        	</h:inputText>
                					<h:outputText value="(MilliSeconds)" target="_blank" />
		                			<h:outputText value="&nbsp;" />
		        		        	<a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				        		        Remove
                					</a4j:commandLink>
		        		        </rich:treeNode>
        		        		<rich:treeNode type="qname">
		        		        	<h:outputText value="#{node.type} : #{node.name} " styleClass="tipoCampo" />
        				        	<h:selectBooleanCheckbox id="foo4-chk" value="#{node.notNil}" disabled="#{node.notNillable}" >
		        		        	   <f:ajax />
				        	        </h:selectBooleanCheckbox>
		        		        	<h:inputText id="foo4" value="#{node.nameSpace}">
        		        			   <f:ajax event="valueChange" render="foo4-chk" listener="#{clientConversationBean.onInputFocus(node)}" />
		                			</h:inputText>
				                	<h:outputText value=" : " />
        				        	<h:inputText value="#{node.localPart}" />
        		        			<h:outputText value="&nbsp;" />
		                			<a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				                		Remove
        				        	</a4j:commandLink>
        				        </rich:treeNode>
                				<rich:treeNode type="Enumeration">
		                			<h:outputText value="#{node.type} : #{node.name} " styleClass="tipoCampo" />
				                	<h:selectBooleanCheckbox id="foo5-chk" value="#{node.notNil}" disabled="#{node.notNillable}" >
        				        	   <f:ajax />
		        			        </h:selectBooleanCheckbox>
        		        			<h:selectOneMenu id="foo5" value="#{node.value}" onfocus="document.getElementById(this.id + '-chk').checked=true">
		        		        		<f:selectItems value="#{node.validValue}" />
        				        	</h:selectOneMenu>
                					<h:outputText value="&nbsp;" />
        		        			<a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				                		Remove
                					</a4j:commandLink>
		                		</rich:treeNode>
				                <rich:treeNode type="byteArray">
				                	<h:outputText value="#{node.type} : #{node.name} " />
        					        <h:selectBooleanCheckbox id="foo6-chk" value="#{node.notNil}" disabled="#{node.notNillable}" >
		        			           <f:ajax />
				        	        </h:selectBooleanCheckbox>
					                <h:inputText value="#{node.value}" id="foo6" >
        					           <f:ajax event="valueChange" render="foo6-chk" listener="#{clientConversationBean.onInputFocus(node)}" />
		        			        </h:inputText>
				        	        <a4j:commandLink action="#{clientConversationBean.removeChild(node)}" rerender="richTree" rendered="#{node.removable}">
				                		Remove
                					</a4j:commandLink>
		        		        </rich:treeNode>
        		            </rich:tree>
        		            <br />
                            <rich:panel>
        		                <h:panelGrid columns="2">
        		                    <h:outputLabel value="Override target address:" for="invUrlInput"/>
                                    <h:inputText id="invUrlInput" value="#{clientConversationBean.invocationUrl}" />
                                    <h:outputLabel value="User:" for="invUser"/>
                                    <h:inputText id="invUser" value="#{clientConversationBean.invocationUser}" />
                                    <h:outputLabel value="Password:" for="invPwd"/>
                                    <h:inputSecret id="invPwd" value="#{clientConversationBean.invocationPwd}" redisplay="true" />
        		                </h:panelGrid>
        		            </rich:panel>
        		            
                    <rich:popupPanel id="popupPreview" modal="true" resizeable="true" onmaskclick="#{rich:component('popupPreview')}.hide()" minWidth="550" minHeight="450">
                        <f:facet name="header">
                            <h:outputText value="SOAP request message preview" />
                        </f:facet>
                        <f:facet name="controls">
                            <h:outputLink value="#" onclick="#{rich:component('popupPreview')}.hide(); return false;">X</h:outputLink>
                        </f:facet>
                        <p>Below is a preview of the SOAP message that will be generated upon invocation. The actual message going on the wire might be different
                           depending on the selected service policy (security, addressing, reliable-messaging, etc.), if any.</p>
                        <div align="center"><h:inputTextarea value="#{clientConversationBean.requestPreview}" cols="80" rows="20" readonly="true" styleClass="preformatted"/></div>
                    </rich:popupPanel>
        
        </a4j:outputPanel>
        
        </rich:panel>
        <div class="navPanel" style="width: 100%;">
            <a4j:commandButton value="&lt;&lt; Back" style="float:left">
                <rich:toggleControl targetItem="@prev" event="click" />
            </a4j:commandButton>
            <a4j:commandButton value="Invoke &gt;&gt;" style="float:right">
                <rich:toggleControl targetItem="@next" event="click" />
            </a4j:commandButton>
            <a4j:commandButton value="Preview message" render="popupPreview" action="#{clientConversationBean.generateRequestPreview}" style="float:right"
                id="previewButton" oncomplete="#{rich:component('popupPreview')}.show();">
            </a4j:commandButton>
        </div>
            
</ui:composition>
